<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:x="http://www.texmacs.org/2002/extensions" xmlns:m="http://www.w3.org/1998/Math/MathML">
  <head>
    <title>No title</title>
    <meta content="TeXmacs 1.99.6" name="generator"></meta>
    <style type="text/css">
      body { text-align: justify } h5 { display: inline; padding-right: 1em }
      h6 { display: inline; padding-right: 1em } table { border-collapse:
      collapse } td { padding: 0.2em; vertical-align: baseline } .subsup {
      display: inline; vertical-align: -0.2em } .subsup td { padding: 0px;
      text-align: left} .fraction { display: inline; vertical-align: -0.8em }
      .fraction td { padding: 0px; text-align: center } .wide { position:
      relative; margin-left: -0.4em } .accent { position: relative;
      margin-left: -0.4em; top: -0.1em } .title-block { width: 100%;
      text-align: center } .title-block p { margin: 0px } .compact-block p {
      margin-top: 0px; margin-bottom: 0px } .left-tab { text-align: left }
      .center-tab { text-align: center } .balloon-anchor { border-bottom: 1px
      dotted #000000; outline:none;                  cursor: help; position:
      relative; }.balloon-anchor [hidden] { margin-left: -999em; position:
      absolute; display: none; }.balloon-anchor:hover [hidden] { position:
      absolute; left: 1em; top: 2em; z-index: 99; margin-left: 0; width:
      500px; display: inline-block; }.balloon-body { }.ornament  {
      border-width: 1px; border-style: solid; border-color:  black; display:
      inline-block; padding: 0.2em; } .right-tab { float: right; position:
      relative; top: -1em } 
    </style>
  </head>
  <body>
    <p>
      <strong>stochastics</strong> is a little Java library I've put together
      to do estimation, simulation and prediction of a class of
      'self-exciting' stochastic processes called Hawkes processes.
    </p>
    <p>
      For example, you can download <a href="https://github.com/crowlogic/stochastics/raw/master/SPY.mat">SPY.mat</a> which is the data
      corresponding to a marked point process of trades of the SPDR S&amp;P
      500 ETF on a particular 6.5 hour trading day sometime in 2016, the
      autocorrelation of the timing between trades has a long-memory where the
      autocorrletion is significant after a very large number of lags. It is a
      known fact that a long-memory point process like this indicates that the
      process is &ldquo;at criticality&rdquo; in that its branching ratio is
      fixed precisely at 1.0, which is the boundary between extinction and
      explosion. See <a href="https://github.com/crowlogic/stochastics/raw/master/docs/HawkesBranchingPointProcessesWithoutAncestors.pdf">Hawkes branching point processes without
      ancestors</a> for proof and <a href="https://arxiv.org/abs/1302.1405">Critical reflexivity in financial
      markets: a Hawkes process analysys</a> for further elaboration. 
    </p>
    <table style="width: 100%">
      <tbody><tr>
        <td style="text-align: center; padding-left: 0em; padding-right: 0em"><img src="Tautocorr.png" height="441.4335088" width="589.0466248"></img></td>
      </tr><tr>
        <td style="text-align: center; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: center; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 1. </b><a id="auto-1"></a>Autocorrelation of time between trades
            during the first 30 minutes of trading of SPY on one particular
            day in the year 2016. This autocorrelation spectrum is very
            typical of almost every other day.
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      With this particular pointset loaded, run the java program <a href="https://github.com/crowlogic/stochastics/blob/master/src/stochastic/pointprocesses/selfexciting/ProcessEstimator.java">ProcessEstimator</a>
      and you will see something like this
    </p>
    <p>
      <font size="-4"><p>
        Estimating parameters for SPY.mat
      </p><p>
        E[dt]=180.0731913776857<span style="margin-left: 2em"></span>&lt;<font color="red">Average
        time between trades across the entire 6.5 hour session , in units of
        milliseconds </font>)
      </p><p>
        E_0[dt]=101.08133459977739<span style="margin-left: 1em"></span><font color="red">&lt;Average
        time vetween trades of the first 30 minutes of regularly scheduled
        trading, in units of milliseconds</font> )
      </p><p>
        &#xFB00;[31;107mspawning &#xFB00;[95m24&#xFB00;[32m
        ExtendedApproximatePowerlawSelfExcitingProcess&#xFB00;[31;107mes to
        estimate the model parameters &#xFB00;[94m[,,,b&#xFB00;[31;107m] most
        likely to have generated the observed sequence of
        &#xFB00;[95m17804&#xFB00;[31;107m timestamps&#xFB00;[m
      </p><p>
        &#xFB00;[31m           thread-13      #1/24  Storing 1.0000000000
        0.0000000000 3.0255799155 1.7241985792  with LL score
        1718889.4428270236&#xFB00;[39m
      </p><p>
        &#xFB00;[31m            thread-3      #3/24  Storing 1.0000000000
        0.0000000000 3.0251966081 1.7246375499  with LL score
        1718889.442804567&#xFB00;[39m
      </p><p>
        &#xFB00;[31m           thread-15      #2/24  Storing 1.0000000000
        0.0000000000 3.0255466416 1.7242359036  with LL score
        1718889.4428268662&#xFB00;[39m
      </p><p>
        &#xFB00;[31m            thread-8      #5/24  Storing 1.0000000000
        0.0000000000 3.0295636875 1.7206915112  with LL score
        1718889.4412852346&#xFB00;[39m
      </p><p>
        &#xFB00;[31m            thread-6      #4/24  Storing 1.0000000000
        0.0000000000 3.0255781444 1.7241991514  with LL score
        1718889.4428270238&#xFB00;[39m
      </p><p>
        &hellip;&hellip;&hellip;&hellip;
      </p><p>
        &#xFB00;[31m            thread-8     #22/24  Storing 1.0000000000
        0.0000000000 3.0255731777 1.7242194415  with LL score
        1718889.442826963&#xFB00;[39m
      </p><p>
        &#xFB00;[31m            thread-2     #21/24  Storing 1.0000000000
        0.0000000000 3.0255960057 1.7241934397  with LL score
        1718889.4428270042&#xFB00;[39m
      </p><p>
        estimation completed in 0.542400 minutes at 74.084317 evals/sec
      </p><p>
        parameter estimates for
        ExtendedApproximatePowerlawSelfExcitingProcess{=1.0,=0.0,=3.0295636875196883,b=1.7206915111784111,Z=20.212944519689493,Edt=135.725254656012}
      </p><p>
        _____________________________________________________________________________________________________________________________________________________________________________________________________________________
      </p><p>
        |   |   |                  | b                 | Log-Lik          
        | KS(Lambda)             | mean(Lambda)           | var(Lambda)       
        | MM(Lambda)               | LB(Lambda)             | MMLB(Lambda)
        | E[dt]             |
      </p><p>
        |====================================================================================================================================================================================================================|
      </p><p>
        1. | 1.0| 0.03.0295636875196883| | 1.7206915111784111|
        1718889.4412852346| 0.866404942169227 | 0.9994319031632158|
        0.9601678843210508| 0.02105209014603504 | 1300.3947948630428|
        0.15096857806824288| 135.725254656012  |
      </p><p>
        2. | 1.0| 0.0| 3.0255558095751067| 1.7241933312893514|
        1718889.4428269528| 0.8663128815718412| 0.9994320070964131|
        0.9597795977901094| 0.02124602560415001 | 1299.8196125605334|
        0.15234993419140458| 135.67557364607737|
      </p><p>
        3. | 1.0| 0.0| 3.0255794239386953| 1.7241903564322218|
        1718889.4428270115| 0.8663131085461994| 0.9994320079874562|
        0.9597784615931496| 0.021246591921049607| 1299.8388017200318|
        0.15235430852694057| 135.67514849842505|
      </p><p>
        4. | 1.0| 0.0| 3.0255810148945113| 1.724191059476018 |
        1718889.442827015 | 0.8663131076913555| 0.9994320081242861|
        0.9597782101066586| 0.021246717390713044| 1299.8409012782388|
        0.15235524253260319| 135.67508318612306|
      </p><p>
        5. | 1.0| 0.0| 3.025566171530826 | 1.7242003859853978|
        1718889.4428270126| 0.8663128317578   | 0.9994320081980411|
        0.959777480464975 | 0.021247082064086764| 1299.8354973653923|
        0.15235776925594738| 135.67504778074579|
      </p><p>
        &bdquo;&bdquo;&bdquo;&bdquo;&bdquo;,
      </p><p>
        19. | 1.0| 0.0| 3.0255808158401374| 1.724205552880895 |
        1718889.4428270133| 0.8663128472027217| 0.9994320093466433|
        0.9597754181804553| 0.021248110909794615| 1299.8536587223991|
        0.15236544351290007| 135.67449954231628|
      </p><p>
        20. | 1.0| 0.0| 3.025574541481823 | 1.7242116484463734|
        1718889.4428270014| 0.8663126920826797| 0.9994320095608489|
        0.9597746928372614| 0.0212484731531023  | 1299.853297077291 |
        0.15236803517130917| 135.6743971852654 |
      </p><p>
        21. | 1.0| 0.0| 3.025613200916328 | 1.7241987316644454|
        1718889.4428269141| 0.8663132074745514| 0.9994320103355935|
        0.9597743908429659| 0.02124862260120053 | 1299.8775285846236|
        0.15236950263288776| 135.67402776061152|
      </p><p>
        22. | 1.0| 0.0| 3.0255731776959305| 1.724219441518698 |
        1718889.442826963 | 0.8663125427688295| 0.9994320101572236|
        0.959773282760179 | 0.021249176999232344| 1299.858994166482 |
        0.1523731753546449 | 135.67411241608536|
      </p><p>
        23. | 1.0| 0.0| 3.02554664157473  | 1.7242359035798402|
        1718889.4428268662| 0.8663120532459874| 0.9994320102710825|
        0.9597720193294557| 0.021249808486941024| 1299.8491439720772|
        0.15237754270850248| 135.6740577131032 |
      </p><p>
        24. | 1.0| 0.0| 3.025196608086467 | 1.7246375499354134|
        1718889.442804567 | 0.8663022985818155| 0.9994320274511848|
        0.9597196394329696| 0.02127596408473742 | 1299.8839023458731|
        0.15256566703137792| 135.66585037341952|
      </p><p>
        
      </p><p>
        writing timestamp data, compensator, intensity, and innovation to
        stochastics/test0.mat and parameters to
        stochastics/test0.mat.eapl.model
      </p><p>
        
      </p></font>
    </p>
    <p>
      The output of this process is two files called 'test0.mat' and
      'test0.mat.eapl.model', the second one is just a raw binary
      representation of the parameters of the process, whereas the first one
      is a matlab compatible file that has the input data, along with the
      estimated intensity and compensator of the process,  which can be tested
      for goodness-of-fit and verifying certain hypothesis about the data. The
      innovation process, which is the difference betweem the predicted
      durations vs the actual observed durations, is also written to the
      ProcessEstimator output .mat file. If the model is a good fit for the
      data then the the compensator will be a unit-rate Poisson process with
      no auto-correlation, that is, if the model is a good fit to the data
      then the mean and variance of the variable
      '<strong>compensator</strong>' (otherwise denoted <img src="index-1.png" style="vertical-align: -0.232727272727273px"></img>
      since matlab doesn't support UTF characters in variable names) in
      test0.mat are both equal to 1 and there will be no detectable
      autocorrelation for any lags other than 0. These tests are determined by
      comparing the statistics of each of the candidate solutions
    </p>
    <p>
      <img src="index-2.png" style="vertical-align: -38.0836363636364px"></img>
    </p>
    <p>
      
    </p>
    <p>
      The column-labels indicate the parameters and summary statistics of a
      set of candidate solutions which are local minimima of the likelihood
      surface of the data given the parameters <img src="index-3.png" style="vertical-align: -3.60727272727273px"></img> and
      they are ranked in order of best fit to worst fit according to the
      column <img src="index-4.png" style="vertical-align: -4.07272727272727px"></img>. The summary statistics are
    </p>
    <ul>
      <li>
        <p>
          Log-Lik=<img src="index-5.png" style="vertical-align: -5.48909090909091px"></img> is the logarithm of the likelihood
          score which is defined in closed-form by
        </p>
        <center>
          <img src="index-6.png" style="vertical-align: -35.7468181818182px"></img>
        </center>
      </li>
      <li>
        <p>
          <img src="index-7.png" style="vertical-align: -4.07272727272727px"></img> is actually 1 minus the Kolomogorov-Smirnov
          statistic 
        </p>
        <center>
          <img src="index-8.png" style="vertical-align: -10.1213636363636px"></img>
        </center>
      </li>
      <li>
        <p>
          mean(&Lambda;)=<img src="index-9.png" style="vertical-align: -6.94045454545455px"></img>
        </p>
      </li>
      <li>
        <p>
          <img src="index-10.png" style="vertical-align: -6.94045454545455px"></img>
        </p>
      </li>
      <li>
        <p>
          <img src="index-11.png" style="vertical-align: -4.07272727272727px"></img> is a moment-matching measure defined by
        </p>
        <center>
          <img src="index-12.png" style="vertical-align: -4.07272727272727px"></img>
        </center>
      </li>
      <li>
        <p>
          <img src="index-13.png" style="vertical-align: -4.07272727272727px"></img> is the Ljung-Box statistic, which tests for
          serial autocorrelation, defined by
        </p>
        <center>
          <img src="index-14.png" style="vertical-align: -16.9222727272727px"></img>
        </center>
        <p>
          where <img src="index-15.png" style="vertical-align: -3.60727272727273px"></img> is the sample autocorrelation at lag
          <img src="index-16.png" style="vertical-align: -0.349090909090909px"></img> given by 
        </p>
        <center>
          <img src="index-17.png" style="vertical-align: -16.5668181818182px"></img>
        </center>
      </li>
      <li>
        <p>
          MMLB(<img src="index-1.png" style="vertical-align: -0.232727272727273px"></img>) is a combination moment-matching
          autocorrelation minimizing metric
        </p>
        <center>
          <img src="index-18.png" style="vertical-align: -4.07272727272727px"></img>
        </center>
      </li>
      <li>
        <p>
          and finally <img src="index-19.png" style="vertical-align: -4.07272727272727px"></img> is the unconditional expected
          mean time between points of the process
        </p>
        <center>
          <img src="index-20.png" style="vertical-align: -64.3918181818182px"></img>
        </center>
        <p>
          where
        </p>
        <table width="100%">
          <tr>
            <td width="100%" align="center"><img src="index-21.png" style="vertical-align: -18.6613636363636px" id="gamma"></img></td>
            <td align="right">(1)</td>
          </tr>
        </table>
        <p>
          and
        </p>
        <table width="100%">
          <tr>
            <td width="100%" align="center"><img src="index-22.png" style="vertical-align: -4.07272727272727px"></img></td>
            <td align="right">(2)</td>
          </tr>
        </table>
        <p>
          when <img src="index-23.png" style="vertical-align: -0.349090909090909px"></img> is not denoted and the exponential
          powerlaw weights <img src="index-24.png" style="vertical-align: -4.66954545454545px"></img> and <img src="index-25.png" style="vertical-align: -4.66954545454545px"></img>
          are a function of the parameters <img src="index-3.png" style="vertical-align: -3.60727272727273px"></img> defined by
        </p>
        <center>
          <img src="index-26.png" style="vertical-align: -0.232727272727273px"></img>
        </center>
        <table width="100%">
          <tr>
            <td width="100%" align="center"><img src="index-27.png" style="vertical-align: -14.3963636363636px"></img></td>
            <td align="right">(3)</td>
          </tr>
        </table>
        <center>
          <img src="index-28.png" style="vertical-align: -14.4109090909091px"></img>
        </center>
        <p>
          and
        </p>
        <center>
          <img src="index-29.png" style="vertical-align: -18.6613636363636px"></img>
        </center>
        <p>
          with <img src="index-30.png" style="vertical-align: -1.51272727272727px"></img> and <img src="index-31.png" style="vertical-align: -0.698181818181818px"></img> and <img
          src="index-32.png" style="vertical-align: -0.349090909090909px"></img>so that the exponential powerlaw-approximation
          covers about 15 minutes with a resolution of 1 minute. The
          additional weight <img src="index-33.png" style="vertical-align: -0.349090909090909px"></img> to allow for a smooth-drop
          to zero as described in <a href="https://arxiv.org/abs/1302.1405">Critical reflexivity in financial
          markets: a Hawkes process analysys</a>
        </p>
      </li>
    </ul>
    <p>
      
    </p>
    <p>
      All times are in units of milliseconds unless otherwise specified. As we
      can see, the theoretical mean of the estimated model is 135.67..ms which
      is not far from the emperical sample mean of <img src="index-34.png" style="vertical-align: -2.69136363636364px"></img>[dt]=101.08133459977739
      which is the sample mean of the mean time between trades in the first 30
      minutes. The mean and variance of the compensator is also very close to
      1, and the autocorrelation is relatively small compared to the input
      data.
    </p>
    <p>
      Here is a qqplot, or quantile-quantile plot, of the compensated process
      <img src="index-35.png" style="vertical-align: -2.575px"></img> versus the unit exponential distribution,
    </p>
    <table style="width: 100%">
      <tbody><tr>
        <td style="text-align: center; padding-left: 0em; padding-right: 0em"><img src="qq.png" height="521.5663432" width="603.1050168"></img></td>
      </tr><tr>
        <td style="text-align: center; padding-left: 0em; padding-right: 0em; height: 0.5em"></td>
      </tr><tr>
        <td style="text-align: center; padding-left: 0em; padding-right: 0em; padding-left: 1.5em; padding-right: 1.5em"><p>
          <font size="-1"><p>
            <b>Figure 2. </b><a id="auto-2"></a>QQ plot of <img src="index-36.png" style="vertical-align: -0.232727272727273px"></img>
            versus the unit exponential distribution <img src="index-37.png" style="vertical-align: -0.349090909090909px"></img>
          </p></font>
        </p></td>
      </tr></tbody>
    </table>
    <p>
      
    </p>
  </body>
</html>